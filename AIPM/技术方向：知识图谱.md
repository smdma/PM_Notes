# 知识图谱基础（1）-什么是知识图谱

参考资料：

[AI技术分支——浅谈知识图谱.人人都是产品经理](http://www.woshipm.com/ai/1181709.html)

[6个方面分析：知识图谱的价值和应用.人人都是产品经理](http://www.woshipm.com/it/1088237.html)

[从10个实际项目总结：关联图谱可以怎么用（上）.人人都是产品经理](http://www.woshipm.com/it/1060345.html)

[什么是关联图谱？.人人都是产品经理](http://www.woshipm.com/it/1057792.html)

[知识图谱：专治各种“撒币”.人人都是产品经理](http://www.woshipm.com/it/912584.html)

[知识图谱在推荐系统的落地.人人都是产品经理](http://www.woshipm.com/pmd/1640689.html)【未整理】

[知识图谱在风控的应用.人人都是产品经理](http://www.woshipm.com/pd/1292806.html)【未整理】





## 知识图谱的定义

知识图谱在国内属于一个比较新兴的概念，国内目前paper都比较少，应用方主要集中在BAT这类手握海量数据的企业，这个概念是google在2012年提出的，当时主要是为了将传统的keyword-base搜索模型向基于语义的搜索升级。知识图谱可以用来更好的查询复杂的关联信息，从语义层面理解用户意图，改进搜索质量。

个人认为，**知识图谱最大的优势是在于对数据的描述能力非常强大**，各种机器学习算法虽然在预测能力上很不错，但是在描述能力上非常弱，知识图谱刚好填补了这部分空缺。

知识图谱的定义非常多，我这里提供一部分我自己的理解：

1.**知识图谱主要目标是用来描述真实世界中存在的各种实体和概念，以及他们之间的强关系，我们用关系去描述两个实体之间的关联**，例如姚明和火箭队之间的关系，他们的属性，我们就用“属性--值对“来刻画它的内在特性，比如说我们的人物，他有年龄、身高、体重属性。简单解释就是：**将需要的知识数据（结构化或非结构化数据）以图谱的形式进行展示**，这种简单的过程也是知识图谱的构建过程。

2.知识图谱可以通过人为构建与定义，去描述各种概念之间的弱关系，例如：“忘了订单号”和“找回订单号”之间的关系

**构建知识图谱这个过程的本质，就是让机器形成认知能力，去理解这个世界。**

在“AI感知”通向“AI理解”的大路上，知识图谱近乎是无法绕开的一道关卡。



## 知识库的概念

#### 知识库的种类

知识库目前可以分为两种类型：**Curated KBs** 和 **Extracted KBs**。

**Curated KBs**：以yago2和freebase为代表，他们从维基百科和WordNet等知识库抽取了大量的实体及实体关系，可以把它理解城一种结构化的维基百科。

**\*Extracted KBs***：主要是以Open Information Extraction (Open IE),  Never-Ending Language Learning (NELL)为代表，他们直接从上亿个网页中抽取实体关系三元组。与freebase相比，这样得到的实体知识更具有多样性，而它们的实体关系和实体更多的则是自然语言的形式，如“姚明出生于上海。” 可以被表示为(“Yao Ming”, “was also born in”, “Shanghai”)。直接从网页中抽取出来的知识，也会存在一定的噪声，其精确度低于Curated KBs。

> 目前行业内使用的比较多的还是**Curated KBs***,*主要是因为**\*Curated KBs***比较简单，容易构建，噪音少。

#### 什么是知识库

a)“姚明出生于上海”

b)“姚明是篮球运动员”

c)“姚明是现任中国篮协主席”

以上就是一条条知识，把大量的知识汇聚起来就成为了知识库（Knowledge Base）。我们可以从wikipedia，百度百科等百科全书获取到大量的知识。但是，这些百科全书的知识是由非结构化的自然语言组建而成的，这样的组织方式很适合人们阅读但并不适合计算机处理。

![img](https://upload-images.jianshu.io/upload_images/3965088-3d02f0951de51552.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/417)

图1：知识图实例

我们以搜索：“姚明的妻子是谁？”这句话为例，其对应结果三元组规则为{实体:姚明，关系:配偶，实体:叶莉}，

而当我们改以搜索：“叶莉今年多大?”进行检索，其对应结果三元组规则为{实体:叶莉，属性:age，属性值:34}，

> 知识图谱旨在描述真实世界中存在的各种实体或概念，因此知识整理进行入库时，对应的知识内容都会转为实体（eneity）概念，每个实体上都会标示一个唯一ID，并且每个对象属性值（attribute-value）用来刻画实体的内在特性，而关系(relation)用来连接两个实体，刻画它们之间的关联。
>
> 因此，将无数实体以对应关系的形式进行存储，知识图谱亦可被构建成一张巨大的网络图。
>
> 其中上述提到的实体、关系、属性，在存储之前都需要采用**RDF方式**对其进行结构化声明，即需要**事先定义一套标准的schema**在抽取数据之前做预备工作，由于是标准的schema，所以不管是抽取结构化数据或非结构化数据，内容都是适用的。

#### 知识库的表示形式

为了方便计算机的处理和理解，我们需要更加形式化、简洁化的方式去表示知识，那就是**`三元组（triple）`**。

“姚明出生于中国上海” 可以用三元组表示为(Yao Ming, PlaceOfBirth, Shanghai)[1]。这里我们可以简单的把三元组理解为**(实体entity,实体关系relation,实体entity)**。如果我们把实体看作是结点，把实体关系（包括属性，类别等等）看作是一条边，那么包含了大量三元组的知识库就成为了一个庞大的知识图。

有些时候会将实体称为**`topic`**，如Justin Bieber。**实体关系也可分为两种，一种是属性property，一种是关系relation**。如下图所示，属性和关系的最大区别在于，**属性所在的三元组对应的两个实体，常常是一个topic和一个字符串，如属性Type/Gender，对应的三元组（Justin Bieber, Type, Person），而关系所在的三元组所对应的两个实体，常常是两个topic。如关系PlaceOfBrith，对应的三元组（Justin Bieber, PlaceOfBrith, London）**。





![img](https://upload-images.jianshu.io/upload_images/3965088-9ef830ae22be10e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/451)

图2：Justin Bieber知识图

（图中蓝色方块表示topic，橙色椭圆包括属性值，它们都属于知识库的实体；蓝色直线表示关系，橙色直线表示属性，它们都统称为知识库的实体关系，都可以用三元组刻画实体和实体关系）

#### 知识库的数据结构 

这里只是简单介绍一下数据结构，知识表达这一块会在《知识图谱基础（2）-知识图谱的知识表达系统》中详细讲解。

读者只要记住，**freebase的基础知识表达形式：(实体)-[关系]-(实体)，(实体)-[关系]-(值)**即可，参考图3，姚明和叶莉的关系。

![img](https://upload-images.jianshu.io/upload_images/3965088-f8c81113b338620d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/698)

图3 知识表达

## 知识图谱的应用

![img](https://upload-images.jianshu.io/upload_images/3965088-df349a08c1dd4d33.png?imageMogr2/auto-orient/)

图4 知识图谱的应用

知识图谱**将传统基于关键字的搜索模型转向基于语义的搜索升级。**

目前知识图谱产品的客户行业，分类主要集中在：社交网络、人力资源与招聘、金融、保险、零售、广告、物流、通信、IT、制造业、传媒、医疗、电子商务和物流等领域。在风控领域中，知识图谱类产品主要应用于反欺诈、反洗钱、互联网授信、保险欺诈、银行欺诈、电商欺诈、项目审计作假、企业关系分析、罪犯追踪等场景中。

在语义搜索这一块，知识图谱的搜索不同于常规的搜索，常规的搜索是根据keyword找到对应的网页集合，然后通过page rank等算法去给网页集合内的网页进行排名，然后展示给用户；基于知识图谱的搜索是在已有的图谱知识库中遍历知识，然后将查询到的知识返回给用户，通常如果路径正确，查询出来的知识只有1个或几个，相当精准。

问答系统这一块，系统同样会首先在知识图谱的帮助下对用户使用自然语言提出的问题进行语义分析和语法分析，进而将其转化成结构化形式的查询语句，然后在知识图谱中查询答案。



那相比传统数据存储和计算方式，知识图谱的优势显现在哪里呢？

**（1）关系的表达能力强**

传统数据库通常通过表格、字段等方式进行读取，而关系的层级及表达方式多种多样，且基于图论和概率图模型，可以处理复杂多样的关联分析，满足企业各种角色关系的分析和管理需要。

**（2）像人类思考一样去做分析**

基于知识图谱的交互探索式分析，可以模拟人的思考过程去发现、求证、推理，业务人员自己就可以完成全部过程，不需要专业人员的协助。

**（3）知识学习**

利用交互式机器学习技术，支持根据推理、纠错、标注等交互动作的学习功能，不断沉淀知识逻辑和模型，提高系统智能性，将知识沉淀在企业内部，降低对经验的依赖。

**（4）高速反馈**

图式的数据存储方式，相比传统存储方式，数据调取速度更快，图库可计算超过百万潜在的实体的属性分布，可实现秒级返回结果，真正实现人机互动的实时响应，让用户可以做到即时决策。



## **整体架构与核心功能点**

### 1、知识建模

知识建模，即为知识和数据进行抽象建模，主要包括以下5个步骤：

1. 以节点为主体目标，实现对不同来源的数据进行映射与合并。（确定节点）
2. 利用属性来表示不同数据源中针对节点的描述，形成对节点的全方位描述。（确定节点属性、标签）
3. 利用关系来描述各类抽象建模成节点的数据之间的关联关系，从而支持关联分析。（图设计）
4. 通过节点链接技术，实现围绕节点的多种类型数据的关联存储。（节点链接）
5. 使用事件机制描述客观世界中动态发展，体现事件与节点间的关联，并利用时序描述事件的发展状况。（动态事件描述）

### 2、知识获取

从不同来源、不同结构的数据中进行知识提取，形成知识存入到知识图谱，这一过程我们称为知识获取。针对不同种类的数据，我们会利用不同的技术进行提取。

**从结构化数据库中获取知识：**D2R。

- **难点：**复杂表数据的处理。

**从链接数据中获取知识：**图映射。

- **难点：**数据对齐。

**从半结构化（网站）数据中获取知识：**使用包装器。

- **难点：**方便的包装器定义方法，包装器自动生成、更新与维护。

**从文本中获取知识：**信息抽取。

- **难点：**结果的准确率与覆盖率。

![img](http://image.woshipm.com/wp-files/2018/07/3CS6bS7IdXwcQz2zUz3a.png)

#### 实体抽取

指的是从原始语料中自动识别出命名实体，由于实体是知识图谱中的最基本元素，其抽取的完整性、准确率、召回率等将直接影响到知识库的质量。因此，实体抽取是知识抽取中最为基础与关键的一步。

### 3、知识融合

如果知识图谱的数据源来自不同数据结构的数据源，在系统已经从不同的数据源把不同结构的数据提取知识之后，接下来要做的是把它们融合成一个统一的知识图谱，这时候需要用到知识融合的技术（如果知识图谱的数据结构均为结构化数据，或某种单一模式的数据结构，则无需用到知识融合技术）。

知识融合主要分为数据模式层融合和数据层融合，分别用的技术如下：

1. 数据模式层融合：概念合并、概念上下位关系合并、概念的属性定义合并。
2. 数据层融合：节点合并、节点属性融合、冲突检测与解决（如某一节点的数据来源有：豆瓣短文、数据库、网页爬虫等，需要将不同数据来源的同一节点进行数据层的融合）。

由于行业知识图谱的数据模式通常采用自顶向下（由专家创建）和自底向上（从现有的行业标准转化，从现有高质量数据源（如百科）转化）结合的方式，在模式层基本都经过人工的校验，保证了可靠性，因此，知识融合的关键任务在数据层的融合。

#### 实体对齐

实体对齐也称为实体匹配或实体解析，主要是用于消除异构数据中实体冲突、指向不明等不一致性问题，可以从顶层创建一个大规模的统一知识库，从而帮助机器理解多源异质的数据，形成高质量的知识。

### 4、知识存储

图谱的数据存储既需要完成基本的数据存储，同时也要能支持上层的知识推理、知识快速查询、图实时计算等应用，因此需要存储以下信息：三元组（由开始节点、关系、结束节点三个元素组成）知识的存储、事件信息的存储、时态信息的存储、使用知识图谱组织的数据的存储。

其关键技术和难点就在于：

1. 大规模三元组数据的存储；
2. 知识图谱组织的大数据的存储；
3. 事件与时态信息的存储；
4. 快速推理与图计算的支持。

### 5、知识推理

知识推理则是在已有的知识库基础上进一步挖掘隐含的知识，从而丰富、扩展知识库。在推理的过程中，往往需要关联规则的支持。由于实体、实体属性以及关系的多样性，人们很难穷举所有的推理规则，一些较为复杂的推理规则往往是手动总结的。

对于推理规则的挖掘，主要还是依赖于实体以及关系间的丰富同现情况。知识推理的对象可以是实体、实体的属性、实体间的关系、本体库中概念的层次结构等。**知识推理方法主要可分为基于逻辑的推理与基于图的推理两种类别**。



**（4）知识更新**

根据知识图谱的逻辑结构，其**更新主要包括模式层的更新与数据层的更新**。模式层的更新是指本体中元素的更新，包括概念的增加、修改、删除，概念属性的更新以及概念之间上下位关系的更新等。

其中，概念属性的更新操作将直接影响到所有直接或间接属性的子概念和实体。通常来说，模式层的增量更新方式消耗资源较少，但是多数情况下是在人工干预的情况下完成的，例如：需要人工定义规则，人工处理冲突等。因此，实施起来并不容易。

**（8）知识计算**

知识计算主要是在知识图谱中知识和数据的基础上，通过各种算法，发现其中显式的或隐含的知识、模式或规则等，知识计算的范畴非常大，这里主要讲三个方面：

1. **图挖掘计算：**基于图论的相关算法，实现对图谱的探索和挖掘。
2. **本体推理：**使用本体推理进行新知识发现或冲突检测。
3. **基于规则的推理：**使用规则引擎，编写相应的业务规则，通过推理辅助业务决策。

**（9）图挖掘和图计算**

知识图谱之上的图挖掘和计算主要分以下6类：

- 第一是图遍历，知识图谱构建完之后可以理解为是一张很大的图，怎么去查询遍历这个图，要根据图的特点和应用的场景进行遍历；
- 第二是图里面经典的算法，如最短路径；
- 第三是路径的探寻，即给定两个实体或多个实体去发现他们之间的关系；
- 第四是权威节点的分析，这在社交网络分析中用的比较多；
- 第五是族群分析；
- 第六是相似节点的发现。

**（10）可视化技术**

目前两个比较常见的可视化工具是：**D3.js和ECharts。**

- **D3.js：**全称Data-Driven Documents，是一个用动态图形显示数据的JavaScript库，一个数据可视化工具，它提供了各种简单易用的函数，大大方便了数据可视化的工作。
- **ECharts：**是一款由百度前端技术部开发的，同样基于Javascript的数据可视化图标库。它提供大量常用的数据可视化图表，底层基于ZRender（一个全新的轻量级canvas类库），创建了坐标系、图例、提示、工具箱等基础组件，并在此上构建出折线图（区域图）、柱状图（条状图）、散点图（气泡图）、饼图（环形图）、K线图、地图、力导向布局图以及和弦图，同时支持任意维度的堆积和多图表混合展现。



## 图数据库

知识图谱的图存储在图数据库（Graph Database）中，图数据库以图论为理论基础，图论中图的基本元素是节点和边，在图数据库中对应的就是节点和关系。用节点和关系所组成的图，为真实世界直观地建模，支持百亿量级甚至千亿量级规模的巨型图的高效关系运算和复杂关系分析。

目前市面上较为流行的图数据库有：Neo4j、Orient DB、Titan、Flock DB、Allegro Graph等。不同于关系型数据库，一修改便容易“牵一发而动全身”。图数据库可实现数据间的“互联互通”，与传统的关系型数据库相比，图数据库更擅长建立复杂的关系网络。

图数据库将原本没有联系的数据连通，将离散的数据整合在一起，从而提供更有价值的决策支持。